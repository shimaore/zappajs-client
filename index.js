// Generated by CoffeeScript 1.12.4
(function() {
  var debug, domready, invariate, observable, pkg, request, riot, socketio, zappa,
    hasProp = {}.hasOwnProperty;

  pkg = {
    name: 'zappajs-client'
  };

  debug = (require('debug'))(pkg.name);

  request = require('superagent');

  socketio = require('socket.io-client');

  domready = require('domready');

  observable = (riot = require('riot')).observable;

  invariate = require('invariate');

  riot.route = require('riot-route');

  zappa = function(options, f) {
    var build_ctx, context, ev, io, ref, ref1, share;
    if (typeof options === 'function') {
      ref = [{}, options], options = ref[0], f = ref[1];
    }
    if (options == null) {
      options = {};
    }
    context = {};
    ev = context.ev = observable();
    if (options.io !== false) {
      io = context.io = socketio((ref1 = options.io) != null ? ref1 : {});
    }
    context.request = request;
    context.riot = riot;
    context.include = function(m) {
      var ref2;
      return (ref2 = m.include) != null ? ref2.call(context, context) : void 0;
    };
    build_ctx = function(o) {
      var ctx, k, v;
      ctx = {
        ev: context.ev,
        io: context.io,
        request: context.request,
        riot: context.riot,
        emit: context.emit,
        on: context.on
      };
      for (k in o) {
        if (!hasProp.call(o, k)) continue;
        v = o[k];
        ctx[k] = v;
      }
      return ctx;
    };
    context.ready = function(f) {
      return context.ev.on('ready', function() {
        var ctx;
        ctx = build_ctx({
          include: context.include,
          settings: context.settings,
          get: context.get,
          route: context.route,
          start: context.start
        });
        return f.apply(ctx);
      });
    };
    context.start = function() {
      riot.route.start();
      return riot.route.exec();
    };
    context.get = context.route = invariate(function(k, v) {
      return riot.route(k, function() {
        var ctx;
        ctx = build_ctx({
          params: arguments,
          query: riot.route.query()
        });
        return v.apply(ctx, arguments);
      });
    });
    context.on = invariate(function(event, action) {
      return io.on(event, function(data, ack) {
        var ctx;
        ctx = build_ctx({
          event: event,
          data: data,
          ack: ack
        });
        return action.apply(ctx, arguments);
      });
    });
    context.emit = invariate.acked(function(event, data, ack) {
      return io.emit.call(io, event, data, function(ack_data) {
        var ctx;
        ctx = build_ctx({
          event: event,
          data: ack_data
        });
        return ack.apply(ctx, arguments);
      });
    });
    if (options.io === false) {
      context.on = function() {
        return debug('Socket.IO is disabled');
      };
      context.emit = function() {
        return debug('Socket.IO is disabled');
      };
    }
    if (f != null) {
      f.call(context, context);
    }
    if (options.io === false) {
      domready(function() {
        debug('DOM is ready');
        return ev.trigger('ready');
      });
      return context;
    }
    share = function(next) {
      var channel_name, ref2, ref3, ref4, uri, zappa_prefix, zappa_server;
      zappa_prefix = (ref2 = context.settings.zappa_prefix) != null ? ref2 : '/zappa';
      channel_name = (ref3 = context.settings.zappa_channel) != null ? ref3 : '__local';
      zappa_server = (ref4 = options.zappa_server) != null ? ref4 : '';
      uri = "" + zappa_server + zappa_prefix + "/socket/" + channel_name + "/" + io.id;
      debug("Requesting " + uri);
      return request.get(uri).accept('json')["catch"](function(error) {
        return {
          body: {
            key: null
          }
        };
      }).then(function(arg) {
        var key;
        key = arg.body.key;
        if (key != null) {
          debug("Sending __zappa_key to server", {
            key: key
          });
          return io.emit('__zappa_key', {
            key: key
          }, next);
        } else {
          return next({
            key: null
          });
        }
      });
    };
    io.on('connect', function() {
      debug("Connect");
      io.emit('__zappa_settings', null, function(settings) {
        debug('Received settings', settings);
        context.settings = settings;
        return share(function(arg) {
          var key;
          key = arg.key;
          debug('Received key', key);
          context.key = key;
          return domready(function() {
            debug('DOM is ready');
            return ev.trigger('ready');
          });
        });
      });
      return debug("Waiting for Zappa settings");
    });
    return context;
  };

  module.exports = zappa;

  module.exports.request = request;

  module.exports.io = socketio;

  module.exports.riot = riot;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC5jb2ZmZWUubWQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFJO0FBQUEsTUFBQSwyRUFBQTtJQUFBOztFQUFBLEdBQUEsR0FBTTtJQUFBLElBQUEsRUFBTSxnQkFBTjs7O0VBQ04sS0FBQSxHQUFRLENBQUMsT0FBQSxDQUFRLE9BQVIsQ0FBRCxDQUFBLENBQWtCLEdBQUcsQ0FBQyxJQUF0Qjs7RUFDUixPQUFBLEdBQVUsT0FBQSxDQUFRLFlBQVI7O0VBQ1YsUUFBQSxHQUFXLE9BQUEsQ0FBUSxrQkFBUjs7RUFDWCxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0VBQ1YsYUFBYyxDQUFBLElBQUEsR0FBTyxPQUFBLENBQVEsTUFBUixDQUFQOztFQUNmLFNBQUEsR0FBWSxPQUFBLENBQVEsV0FBUjs7RUFDWixJQUFJLENBQUMsS0FBTCxHQUFhLE9BQUEsQ0FBUSxZQUFSOztFQUViLEtBQUEsR0FBUSxTQUFDLE9BQUQsRUFBUyxDQUFUO0FBQ04sUUFBQTtJQUFBLElBQUcsT0FBTyxPQUFQLEtBQWtCLFVBQXJCO01BQ0UsTUFBYyxDQUFDLEVBQUQsRUFBSSxPQUFKLENBQWQsRUFBQyxnQkFBRCxFQUFTLFdBRFg7OztNQUVBLFVBQVc7O0lBRVgsT0FBQSxHQUFVO0lBV1YsRUFBQSxHQUFLLE9BQU8sQ0FBQyxFQUFSLEdBQWEsVUFBQSxDQUFBO0lBQ2xCLElBQU8sT0FBTyxDQUFDLEVBQVIsS0FBYyxLQUFyQjtNQUNFLEVBQUEsR0FBSyxPQUFPLENBQUMsRUFBUixHQUFhLFFBQUEsc0NBQXNCLEVBQXRCLEVBRHBCOztJQUVBLE9BQU8sQ0FBQyxPQUFSLEdBQWtCO0lBQ2xCLE9BQU8sQ0FBQyxJQUFSLEdBQWU7SUFDZixPQUFPLENBQUMsT0FBUixHQUFrQixTQUFDLENBQUQ7QUFDaEIsVUFBQTs4Q0FBUyxDQUFFLElBQVgsQ0FBZ0IsT0FBaEIsRUFBeUIsT0FBekI7SUFEZ0I7SUFLbEIs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S0FBQSxDQUFNLG1CQUFOLEVBQTJCLFFBQTNCO1FBQ0EsT0FBTyxDQUFDLFFBQVIsR0FBbUI7ZUFJbkIsS0FBQSxDQUFNLFNBQUMsR0FBRDtBQUNKLGNBQUE7VUFETSxNQUFEO1VBQ0wsS0FBQSxDQUFNLGNBQU4sRUFBc0IsR0FBdEI7VUFLQSxPQUFPLENBQUMsR0FBUixHQUFjO2lCQUlkLFFBQUEsQ0FBUyxTQUFBO1lBQ1AsS0FBQSxDQUFNLGNBQU47bUJBQ0EsRUFBRSxDQUFDLE9BQUgsQ0FBVyxPQUFYO1VBRk8sQ0FBVDtRQVZJLENBQU47TUFQZ0MsQ0FBbEM7YUFxQkEsS0FBQSxDQUFNLDRCQUFOO0lBMUJlLENBQWpCO1dBNEJBO0VBeE9NOztFQTBPUixNQUFNLENBQUMsT0FBUCxHQUFpQjs7RUFDakIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFmLEdBQXlCOztFQUN6QixNQUFNLENBQUMsT0FBTyxDQUFDLEVBQWYsR0FBb0I7O0VBQ3BCLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBZixHQUFzQjtBQXRQdEIiLCJzb3VyY2VzQ29udGVudCI6WyIgICAgcGtnID0gbmFtZTogJ3phcHBhanMtY2xpZW50J1xuICAgIGRlYnVnID0gKHJlcXVpcmUgJ2RlYnVnJykgcGtnLm5hbWVcbiAgICByZXF1ZXN0ID0gcmVxdWlyZSAnc3VwZXJhZ2VudCdcbiAgICBzb2NrZXRpbyA9IHJlcXVpcmUgJ3NvY2tldC5pby1jbGllbnQnXG4gICAgZG9tcmVhZHkgPSByZXF1aXJlICdkb21yZWFkeSdcbiAgICB7b2JzZXJ2YWJsZX0gPSByaW90ID0gcmVxdWlyZSAncmlvdCdcbiAgICBpbnZhcmlhdGUgPSByZXF1aXJlICdpbnZhcmlhdGUnXG4gICAgcmlvdC5yb3V0ZSA9IHJlcXVpcmUgJ3Jpb3Qtcm91dGUnXG5cbiAgICB6YXBwYSA9IChvcHRpb25zLGYpIC0+XG4gICAgICBpZiB0eXBlb2Ygb3B0aW9ucyBpcyAnZnVuY3Rpb24nXG4gICAgICAgIFtvcHRpb25zLGZdID0gW3t9LG9wdGlvbnNdXG4gICAgICBvcHRpb25zID89IHt9XG5cbiAgICAgIGNvbnRleHQgPSB7fVxuXG5Db250ZXh0XG49PT09PT09XG5cblRoZSBaYXBwYUpTLUNsaWVudCBjb250ZXh0IGNvbnRhaW5zIHRoZSBmb2xsb3dpbmcgb2JqZWN0czpcbiogYEBpb2AsIHRoZSBTb2NrZXQuSU8gY2xpZW50LlxuKiBgQHJlcXVlc3RgLCBhIFByb21pc2lmaWVkIGBzdXBlcmFnZW50YCBSRVNUIGNsaWVudC5cbiogYEByaW90YCwgdGhlIHJpb3RqcyBtb2R1bGUuXG4qIGBAZXZgLCBhIFtyaW90LW9ic2VydmFibGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9yaW90L29ic2VydmFibGUvdHJlZS9tYXN0ZXIvZG9jKSAtLSBiYXNpY2FsbHkgeW91IGNhbiBydW4gYC5vbmAgYW5kIGAudHJpZ2dlcmAgb24gaXQuXG5cbiAgICAgIGV2ID0gY29udGV4dC5ldiA9IG9ic2VydmFibGUoKVxuICAgICAgdW5sZXNzIG9wdGlvbnMuaW8gaXMgZmFsc2VcbiAgICAgICAgaW8gPSBjb250ZXh0LmlvID0gc29ja2V0aW8gb3B0aW9ucy5pbyA/IHt9XG4gICAgICBjb250ZXh0LnJlcXVlc3QgPSByZXF1ZXN0XG4gICAgICBjb250ZXh0LnJpb3QgPSByaW90XG4gICAgICBjb250ZXh0LmluY2x1ZGUgPSAobSkgLT5cbiAgICAgICAgbS5pbmNsdWRlPy5jYWxsIGNvbnRleHQsIGNvbnRleHRcblxuVGhlc2Ugb2JqZWN0cyBhcmUgYWx3YXlzIGF2YWlsYWJsZSBpbnNpZGUgaGFuZGxlcnMgYXMgd2VsbCFcblxuICAgICAgYnVpbGRfY3R4ID0gKG8pIC0+XG4gICAgICAgIGN0eCA9XG4gICAgICAgICAgZXY6IGNvbnRleHQuZXZcbiAgICAgICAgICBpbzogY29udGV4dC5pb1xuICAgICAgICAgIHJlcXVlc3Q6IGNvbnRleHQucmVxdWVzdFxuICAgICAgICAgIHJpb3Q6IGNvbnRleHQucmlvdFxuICAgICAgICAgIGVtaXQ6IGNvbnRleHQuZW1pdFxuICAgICAgICAgIG9uOiBjb250ZXh0Lm9uXG4gICAgICAgIGN0eFtrXSA9IHYgZm9yIG93biBrLHYgb2Ygb1xuICAgICAgICBjdHhcblxuVGhlIFphcHBhSlMtQ2xpZW50IGNvbnRleHQgYWxzbyBjb250YWluczpcbiogYEBpbmNsdWRlIG1gIGV4ZWN1dGVzIGBtLmluY2x1ZGVgIHdpdGhpbiB0aGUgWmFwcGFKUyBjb250ZXh0IGl0c2VsZi5cblxuUmVhZHlcbj09PT09XG5cbldoZW4gYWxsIHRoZSBaYXBwYUpTLUNsaWVudCBoYW5kc2hha2UgaXMgZG9uZSwgYW5kIG9uY2UgdGhlIERPTSBpcyByZWFkeSwgdGhlIGNhbGxiYWNrIG9mIGBAcmVhZHlgIGlzIGNhbGxlZCB3aXRoIGl0cyBjb250ZXh0IHNldCB0byB0aGUgWmFwcGFKUy1DbGllbnQgY29udGV4dC5cblxuYGBgXG5AcmVhZHkgLT5cbiAgQGVtaXQgJ3JlYWR5J1xuICBAcmVxdWVzdC5nZXQgJy9kYXRhLmpzb24nXG4gIC50aGVuIChkYXRhKSAtPiBhbGVydCBkYXRhXG4gICMgZXRjLlxuYGBgXG5cbiAgICAgIGNvbnRleHQucmVhZHkgPSAoZikgLT5cbiAgICAgICAgY29udGV4dC5ldi5vbiAncmVhZHknLCAtPlxuICAgICAgICAgIGN0eCA9IGJ1aWxkX2N0eFxuICAgICAgICAgICAgaW5jbHVkZTogY29udGV4dC5pbmNsdWRlXG4gICAgICAgICAgICBzZXR0aW5nczogY29udGV4dC5zZXR0aW5nc1xuICAgICAgICAgICAgZ2V0OiBjb250ZXh0LmdldFxuICAgICAgICAgICAgcm91dGU6IGNvbnRleHQucm91dGVcbiAgICAgICAgICAgIHN0YXJ0OiBjb250ZXh0LnN0YXJ0XG4gICAgICAgICAgZi5hcHBseSBjdHhcblxuUm91dGVyXG49PT09PT1cblxuVGhlIHJvdXRlciBpcyBbcmlvdCdzIHJvdXRlcl0oaHR0cHM6Ly9naXRodWIuY29tL3Jpb3Qvcm91dGUvdHJlZS9tYXN0ZXIvZG9jKS4gSG93ZXZlciBpdCBpcyBub3Qgc3RhcnRlZCB1bnRpbCB5b3UgZXhwbGljaXRlbHkgY2FsbCBgQHN0YXJ0KClgLCBzbyBmZWVsIGZyZWUgdG8gdXNlIHlvdXIgb3duIHJvdXRlciBpbnN0ZWFkIGlmIHlvdSdkIGxpa2UuXG5cbiogYEBzdGFydCgpYCBpcyByZXF1aXJlZCB0byBzdGFydCB0aGUgUmlvdCByb3V0ZXIuXG5cbiAgICAgIGNvbnRleHQuc3RhcnQgPSAtPlxuICAgICAgICByaW90LnJvdXRlLnN0YXJ0KClcbiAgICAgICAgcmlvdC5yb3V0ZS5leGVjKClcblxuKiBgQGdldGAgY2FuIGJlIHVzZWQgdGhlIHNhbWUgd2F5IGFzIFphcHBhSlMnIGBAZ2V0YDsgZXhjZXB0IGl0IHdvcmtzIG9uIHRoZSBoYXNoLXBhdGgsIG5vdCB0aGUgVVJJIHBhdGguXG4gIFlvdSBjYW4gdXNlIGBAcm91dGVgIGlmIHlvdSBwcmVmZXIgdG8gdXNlIHRoZSByaW90anMgbmFtZSBpbnN0ZWFkIG9mIGBAZ2V0YC5cblxuICAgICAgY29udGV4dC5nZXQgPSBjb250ZXh0LnJvdXRlID0gaW52YXJpYXRlIChrLHYpIC0+XG4gICAgICAgIHJpb3Qucm91dGUgaywgLT5cblxuUm91dGUgY29udGV4dFxuLS0tLS0tLS0tLS0tLVxuXG4qIGBwYXJhbXNgIGNvbnRhaW5zIHRoZSAocG9zaXRpb25hbCkgcGFyYW1ldGVycyBpbiBhbiBhcnJheS5cbiogYHF1ZXJ5YCBjb250YWlucyB0aGUgb3B0aW9uYWwgcXVlcnkgcGFyYW1ldGVycyBhcyBhbiBvYmplY3QuXG5cblVzZSAnLi4nIGF0IHRoZSBlbmQgb2YgYSBwYXRoIHRvIG1hdGNoIHF1ZXJ5IGFyZ3VtZW50cy5cblxuRm9yIGV4YW1wbGUgdG8gY2FwdHVyZSBgL2Zvbz9iYXI9M2BcbmBgYFxuQGdldCAnL2Zvby4uJzogLT4gQHF1ZXJ5LmJhclxuYGBgXG5cbiAgICAgICAgICBjdHggPSBidWlsZF9jdHhcbiAgICAgICAgICAgIHBhcmFtczogYXJndW1lbnRzXG4gICAgICAgICAgICBxdWVyeTogcmlvdC5yb3V0ZS5xdWVyeSgpXG4gICAgICAgICAgdi5hcHBseSBjdHgsIGFyZ3VtZW50c1xuXG5Tb2NrZXQuSU9cbj09PT09PT09PVxuXG5BIHNvY2tldC5pbyBjbGllbnQgaXMgaW5jbHVkZWQsIHlvdSBjYW4gaGFuZGxlIGluY29taW5nIG1lc3NhZ2VzIGZyb20gdGhlIHNlcnZlciB1c2luZyBgQG9uYCBhbmQgc2VuZCBtZXNzYWdlcyBiYWNrIHVzaW5nIGBAZW1pdGAuXG5cbiAgICAgIGNvbnRleHQub24gPSBpbnZhcmlhdGUgKGV2ZW50LGFjdGlvbikgLT5cbiAgICAgICAgaW8ub24gZXZlbnQsIChkYXRhLGFjaykgLT5cblxuTWVzc2FnZSBoYW5kbGVyIGNvbnRleHRcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblRoZSBzYW1lIGNvbnRleHQgaXMgcHJvdmlkZWQgZm9yIGBAb25gIGhhbmRsZXIgYXMgaW4gc2VydmVyLXNpZGUgWmFwcGFKUzpcbiogYEBldmVudGAgY29udGFpbnMgdGhlIGV2ZW50J3MgbmFtZTtcbiogYEBkYXRhYCBjb250YWlucyB0aGUgb3B0aW9uYWwgZXZlbnQncyBkYXRhO1xuKiBgQGFja2AgaXMgcHJvdmlkZWQgaWYgdGhlIHNlbmRlciByZXF1ZXN0ZWQgYWNrbm93bGVkZ21lbnQuXG5cbkFkZGl0aW9uYWxseSwgYEBkYXRhYCBhbmQgYEBhY2tgIGFyZSBwcm92aWRlZCBhcyByZWd1bGFyIGFyZ3VtZW50cyBpZiB5b3UnZCByYXRoZXIgdXNlIHRoYXQuXG5cbiAgICAgICAgICBjdHggPSBidWlsZF9jdHhcbiAgICAgICAgICAgIGV2ZW50OiBldmVudFxuICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgYWNrOiBhY2tcbiAgICAgICAgICBhY3Rpb24uYXBwbHkgY3R4LCBhcmd1bWVudHNcblxuICAgICAgY29udGV4dC5lbWl0ID0gaW52YXJpYXRlLmFja2VkIChldmVudCxkYXRhLGFjaykgLT5cbiAgICAgICAgaW8uZW1pdC5jYWxsIGlvLCBldmVudCwgZGF0YSwgKGFja19kYXRhKSAtPlxuXG5BY2sgY29udGV4dFxuLS0tLS0tLS0tLS1cblxuV2hlbiBlbWl0dGluZyBldmVudCwgeW91IG1pZ2h0IHByb3ZpZGUgYSBgYWNrYCBjYWxsYmFjay5cblxuKiBgQGV2ZW50YCBjb250YWlucyB0aGUgZXZlbnQncyBuYW1lO1xuKiBgQGRhdGFgIGNvbnRhaW5zIHRoZSBvcHRpb25hbCBhY2sgZGF0YS5cblxuICAgICAgICAgIGN0eCA9IGJ1aWxkX2N0eFxuICAgICAgICAgICAgZXZlbnQ6IGV2ZW50XG4gICAgICAgICAgICBkYXRhOiBhY2tfZGF0YVxuICAgICAgICAgIGFjay5hcHBseSBjdHgsIGFyZ3VtZW50c1xuXG5EaXNhYmxlIFNvY2tldC5pbyBvbiBvcHRpb25zXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAgIGlmIG9wdGlvbnMuaW8gaXMgZmFsc2VcbiAgICAgICAgY29udGV4dC5vbiA9IC0+XG4gICAgICAgICAgZGVidWcgJ1NvY2tldC5JTyBpcyBkaXNhYmxlZCdcbiAgICAgICAgY29udGV4dC5lbWl0ID0gLT5cbiAgICAgICAgICBkZWJ1ZyAnU29ja2V0LklPIGlzIGRpc2FibGVkJ1xuXG5BcHBseSBVc2VyIEZ1bmN0aW9uXG49PT09PT09PT09PT09PT09PT09XG5cbiAgICAgIGlmIGY/XG4gICAgICAgIGYuY2FsbCBjb250ZXh0LCBjb250ZXh0XG5cbkxvY2FsLW9ubHlcbi0tLS0tLS0tLS1cblxuSWYgdGhlIGBpb2Agb3B0aW9uIGlzIGZhbHNlLCBkbyBub3Qgd2FpdCBmb3IgSU8gY29ubmVjdC5cblxuICAgICAgaWYgb3B0aW9ucy5pbyBpcyBmYWxzZVxuICAgICAgICBkb21yZWFkeSAtPlxuICAgICAgICAgIGRlYnVnICdET00gaXMgcmVhZHknXG4gICAgICAgICAgZXYudHJpZ2dlciAncmVhZHknXG4gICAgICAgIHJldHVybiBjb250ZXh0XG5cbkF1dG9tYXRpY2FsbHkgYmluZGluZyBFeHByZXNzSlMgYW5kIFNvY2tldC5JT1xuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblRoZSBtYWluIHB1cnBvc2Ugb2YgWmFwcGFKUy1DbGllbnQgaXMgdG8gYXV0b21hdGljYWxseSBiaW5kIHRoZSBFeHByZXNzSnMgYW5kIHRoZSBTb2NrZXQuSU8gYEBzZXNzaW9uYCBvYmplY3RzIG9uIHRoZSBzZXJ2ZXIgc2lkZSwgc28gdGhhdCBhbGwgY29kZSBvbiB0aGUgc2VydmVyIGdhaW5zIGFjY2VzcyB0byB0aGUgc2FtZSBzZXNzaW9uIG9iamVjdC5cblRoaXMgd29ya3MgZXZlbiBpZiB0aGUgRXhwcmVzc0pTIGFuZCB0aGUgU29ja2V0LklPIGNvZGUgYXJlIHJ1bm5pbmcgb24gZGlmZmVyZW50IHNlcnZlcnMuXG5cblNoYXJlXG4tLS0tLVxuXG5UaGUgZ29hbCBvZiB0aGUgYHNoYXJlYCBmdW5jdGlvbiBpcyB0byBiaW5kIHRoZSBzb2NrZXQgSUQgd2l0aCB0aGUgRXhwcmVzc0pTIHNlc3Npb24sIHRoZW4gcHJvdmlkZSB0aGUgc2Vzc2lvbiBJRCBiYWNrIHRvIHRoZSBzb2NrZXQuSU8gc2VydmVyLlxuXG4gICAgICBzaGFyZSA9IChuZXh0KSAtPlxuICAgICAgICB6YXBwYV9wcmVmaXggPSBjb250ZXh0LnNldHRpbmdzLnphcHBhX3ByZWZpeCA/ICcvemFwcGEnXG4gICAgICAgIGNoYW5uZWxfbmFtZSA9IGNvbnRleHQuc2V0dGluZ3MuemFwcGFfY2hhbm5lbCA/ICdfX2xvY2FsJ1xuICAgICAgICB6YXBwYV9zZXJ2ZXIgPSBvcHRpb25zLnphcHBhX3NlcnZlciA/ICcnXG5cbkxldCB0aGUgRXhwcmVzcyBzZXJ2ZXIgc2F2ZSBpdHMgc2Vzc2lvbi5pZCBhbmQgYmluZCBpdCB0byB0aGUga2V5LlxuXG4gICAgICAgIHVyaSA9IFwiI3t6YXBwYV9zZXJ2ZXJ9I3t6YXBwYV9wcmVmaXh9L3NvY2tldC8je2NoYW5uZWxfbmFtZX0vI3tpby5pZH1cIlxuICAgICAgICBkZWJ1ZyBcIlJlcXVlc3RpbmcgI3t1cml9XCJcbiAgICAgICAgcmVxdWVzdFxuICAgICAgICAuZ2V0IHVyaVxuICAgICAgICAuYWNjZXB0ICdqc29uJ1xuICAgICAgICAuY2F0Y2ggKGVycm9yKSAtPlxuICAgICAgICAgIGJvZHk6IGtleTogbnVsbFxuICAgICAgICAudGhlbiAoe2JvZHk6e2tleX19KSAtPlxuXG5MZXQgdGhlIHNvY2tldC5pbyBzZXJ2ZXIga25vdyBob3cgdG8gcmV0cmlldmUgdGhlIHNlc3Npb24uaWQgYnkgcHJvdmlkaW5nIGl0IHRoZSBrZXkuXG5cbiAgICAgICAgICBpZiBrZXk/XG4gICAgICAgICAgICBkZWJ1ZyBcIlNlbmRpbmcgX196YXBwYV9rZXkgdG8gc2VydmVyXCIsIHtrZXl9XG4gICAgICAgICAgICBpby5lbWl0ICdfX3phcHBhX2tleScsIHtrZXl9LCBuZXh0XG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgbmV4dCBrZXk6IG51bGxcblxuT24gSU8gY29ubmVjdFxuLS0tLS0tLS0tLS0tLVxuXG5XaGVuIHRoZSBJTyBzb2NrZXQgaXMgY29ubmVjdGVkLFxuXG4gICAgICBpby5vbiAnY29ubmVjdCcsIC0+XG4gICAgICAgIGRlYnVnIFwiQ29ubmVjdFwiXG5cbnJldHJpZXZlIHRoZSBaYXBwYSBhcHBsaWNhdGlvbiBzZXR0aW5ncyxcblxuICAgICAgICBpby5lbWl0ICdfX3phcHBhX3NldHRpbmdzJywgbnVsbCwgKHNldHRpbmdzKSAtPlxuXG4gICAgICAgICAgZGVidWcgJ1JlY2VpdmVkIHNldHRpbmdzJywgc2V0dGluZ3NcbiAgICAgICAgICBjb250ZXh0LnNldHRpbmdzID0gc2V0dGluZ3NcblxudGhlbiBiaW5kIHRoZSBzb2NrZXQgaW4gdGhlIEV4cHJlc3NKUyBzZXNzaW9uLCBhbmQgcHJvdmlkZXMgdGhlIEV4cHJlc3NKUyBzZXNzaW9uIElEIHRvIHRoZSBTb2NrZXQuSU8gc2VydmVyLlxuXG4gICAgICAgICAgc2hhcmUgKHtrZXl9KSAtPlxuICAgICAgICAgICAgZGVidWcgJ1JlY2VpdmVkIGtleScsIGtleVxuXG5XZSBkbyBub3Qgc2F2ZSB0aGUga2V5IGluc2lkZSB0aGUgY29udGV4dCB1bnRpbCBhbGwgdGhlIHN0ZXBzIGFyZSBjb21wbGV0ZWQuXG5Ob3RlOiBUaGUga2V5IGlzIG5vcm1hbGx5IG5vdCBuZWVkZWQuXG5cbiAgICAgICAgICAgIGNvbnRleHQua2V5ID0ga2V5XG5cbkZpbmFsbHksIG9uY2UgdGhlIERPTSBpcyByZWFkeSwgdHJpZ2dlciBhIGByZWFkeWAgZXZlbnQgc28gdGhhdCBvdXIgY2xpZW50LXNpZGUgYXBwbGljYXRpb24gbWF5IHN0YXJ0LlxuXG4gICAgICAgICAgICBkb21yZWFkeSAtPlxuICAgICAgICAgICAgICBkZWJ1ZyAnRE9NIGlzIHJlYWR5J1xuICAgICAgICAgICAgICBldi50cmlnZ2VyICdyZWFkeSdcblxuICAgICAgICBkZWJ1ZyBcIldhaXRpbmcgZm9yIFphcHBhIHNldHRpbmdzXCJcblxuICAgICAgY29udGV4dFxuXG4gICAgbW9kdWxlLmV4cG9ydHMgPSB6YXBwYVxuICAgIG1vZHVsZS5leHBvcnRzLnJlcXVlc3QgPSByZXF1ZXN0XG4gICAgbW9kdWxlLmV4cG9ydHMuaW8gPSBzb2NrZXRpb1xuICAgIG1vZHVsZS5leHBvcnRzLnJpb3QgPSByaW90XG4iXX0=
//# sourceURL=/srv/home/stephane/Artisan/Managed/Node/zappajs-client/index.coffee.md